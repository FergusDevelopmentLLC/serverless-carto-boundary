SELECT 
"STATEFP" as statefp,
state.geom, 
"STUSPS" as stusps, 
"NAME" as name, 
"STATENS" as statens, 
"AFFGEOID" as affgeoid, 
"GEOID" as geoid,
"LSAD" as lsad,
"ALAND" as aland,
"AWATER" as awater,
round(ST_X(centroids.geom)::numeric, 3) as centroid_longitude,
round(ST_Y(centroids.geom)::numeric, 3) as centroid_latitude
FROM public.state_centroids centroids
JOIN cb_2018_us_state_20m state on state.statefp = centroids."STATEFP"
ORDER BY "STATEFP";


SELECT 
  county.id,
  county.geom,
  round(ST_X(ST_CENTROID(county.geom))::numeric, 3) as centroid_longitude,
  round(ST_Y(ST_CENTROID(county.geom))::numeric, 3) as centroid_latitude,
  county.name,
  county.statefp,
  county.countyfp,
  county.countyns,
  county.affgeoid,
  county.geoid,
  county.lsad,
  county.aland,
  county.awater,
  state.name as state_name,
  state.stusps as state_stusps
FROM cb_2018_us_county_20m county
JOIN cb_2018_us_state_20m state on state.statefp = county.statefp
WHERE state.stusps = 'IN';


SELECT table_name
FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_NAME LIKE 'csv_import%';

drop table csv_import_1615223975884,csv_import_1615224189079,csv_import_1615228569099,csv_import_1615228635395,csv_import_1615174016071,csv_import_1615228872238,csv_import_1615229207580,csv_import_1615229298254,csv_import_1615173482082,csv_import_1615175045018,csv_import_1615224002477,csv_import_1615224244913,csv_import_1615228582415,csv_import_1615173533253,csv_import_1615222680140,csv_import_1615224028512,csv_import_1615227872857,csv_import_1615228000083,csv_import_1615228625215,csv_import_1615228831958,csv_import_1615228894744,csv_import_1615173742158,csv_import_1615223718793,csv_import_1615224052221,csv_import_1615229278756,csv_import_1615229319846,csv_import_1615229355850,csv_import_1615173081237,csv_import_1615173784340,csv_import_1615173845968,csv_import_1615223928159,csv_import_1615229391207,csv_import_1615229400728,csv_import_1615229427276,csv_import_1615229450333,csv_import_1615229760851,csv_import_1615229866653,csv_import_1615230611141,csv_import_1615230781818,csv_import_1615230796719,csv_import_1615230807137,csv_import_1615230828363,csv_import_1615230885847,csv_import_1615230937727,csv_import_1615230949232,csv_import_1615231117399,csv_import_1615231140567,csv_import_1615231168776,csv_import_1615231196806,csv_import_1615231265253,csv_import_1615236079939,csv_import_1615236080145,csv_import_1615236162377,csv_import_1615236183241,csv_import_1615236194224,csv_import_1615236206498,csv_import_1615236249520,csv_import_1615237135926,csv_import_1615237329441,csv_import_1615238459102,csv_import_1615238479110,csv_import_1615238975079,csv_import_1615239117266,csv_import_1615239759120,csv_import_1615240130065,csv_import_1615240404186,csv_import_1615240435110,csv_import_1615243644861,csv_import_1615244153845,csv_import_1615244389457,csv_import_1615244950906,csv_import_1615245003092,csv_import_1615245527225,csv_import_1615248317643,csv_import_1615249396943,csv_import_1615249427881,csv_import_1615249634512,csv_import_1615249716191,csv_import_1615249753474,csv_import_1615250110323,csv_import_1615250147817,csv_import_1615250196095,csv_import_1615250236934,csv_import_1615250262707,csv_import_1615250285744,csv_import_1615250808526,csv_import_1615250987302,csv_import_1615251080447,csv_import_1615254872662,csv_import_1615263470793,csv_import_1615263521122,csv_import_1615263588861,csv_import_1615263662981,csv_import_1615263806300,csv_import_1615263879869,csv_import_1615264013500,csv_import_1615264620532,csv_import_1615264875752,csv_import_1615265040656,csv_import_1615265369893,csv_import_1615265618321,csv_import_1615265698539,csv_import_1615265749458,csv_import_1615319702761,csv_import_1615319750502,csv_import_1615320116952,csv_import_1615320195513,csv_import_1615320335482,csv_import_1615320523307,csv_import_1615321073225,csv_import_1615321281759,csv_import_1615321444947,csv_import_1615321577674,csv_import_1615321602074,csv_import_1615321624552,csv_import_1615321655654,csv_import_1615321765873,csv_import_1615321787121,csv_import_1615321799481,csv_import_1615321929660,csv_import_1615322038712,csv_import_1615322197553,csv_import_1615322218011,csv_import_1615322344477,csv_import_1615322374630,csv_import_1615322393993,csv_import_1615322492627,csv_import_1615322543221,csv_import_1615322635679,csv_import_1615322845997,csv_import_1615322854534,csv_import_1615322865591,csv_import_1615322876458,csv_import_1615322898301,csv_import_1615322965024,csv_import_1615322984720,csv_import_1615322994012,csv_import_1615323006212,csv_import_1615323029535,csv_import_1615323045531,csv_import_1615323051780,csv_import_1615324103511,csv_import_1615324821751,csv_import_1615325051311,csv_import_1615325148287,csv_import_1615325555522,csv_import_1615325656037,csv_import_1615326255619,csv_import_1615326801372,csv_import_1615326866316,csv_import_1615326888784,csv_import_1615326923047,csv_import_1615326955745,csv_import_1615326979662,csv_import_1615327098452,csv_import_1615327148261,csv_import_1615327174694,csv_import_1615327240624,csv_import_1615327268862,csv_import_1615327290279,csv_import_1615327308240,csv_import_1615327323341,csv_import_1615327339869,csv_import_1615327366940,csv_import_1615327383348,csv_import_1615327502180,csv_import_1615327523914,csv_import_1615327587384,csv_import_1615327606349,csv_import_1615327617210,csv_import_1615327650144,csv_import_1615327737497,csv_import_1615327758493,csv_import_1615327790936,csv_import_1615327809644,csv_import_1615327825275,csv_import_1615328298821,csv_import_1615328436339,csv_import_1615328484771,csv_import_1615328495541,csv_import_1615329894202,csv_import_1615329946140,csv_import_1615330415603,csv_import_1615330924827,csv_import_1615332378811,csv_import_1615332545553,csv_import_1615333165612,csv_import_1615333258948,csv_import_1615333312103,csv_import_1615333357675,csv_import_1615333680667,csv_import_1615333894904,csv_import_1615333976376,csv_import_1615341945846,csv_import_1615342034765,csv_import_1615342598914,csv_import_1615343010557,csv_import_1615343259800,csv_import_1615343338323,csv_import_1615343422536,csv_import_1615343535459,csv_import_1615343926369,csv_import_1615344029811,csv_import_1615344308382,csv_import_1615344525205,csv_import_1615344569436,csv_import_1615344634187,csv_import_1615344702142,csv_import_1615344923035,csv_import_1615345173347,csv_import_1615345275894,csv_import_1615345308331,csv_import_1615345385613,csv_import_1615345459898,csv_import_1615345530401,csv_import_1615345581914,csv_import_1615345599042,csv_import_1615345815946,csv_import_1615345989836,csv_import_1615346121259,csv_import_1615346176857,csv_import_1615346323877,csv_import_1615346382989,csv_import_1615346458259,csv_import_1615346490959,csv_import_1615346556594,csv_import_1615346634827,csv_import_1615346651759,csv_import_1615346713070,csv_import_1615346816221,csv_import_1615346854301,csv_import_1615347273781,csv_import_1615347291594,csv_import_1615347307904,csv_import_1615347322678,csv_import_1615347342738,csv_import_1615347358189,csv_import_1615347369361,csv_import_1615347395834,csv_import_1615347411718,csv_import_1615347435097,csv_import_1615347452995,csv_import_1615347478078,csv_import_1615347489068,csv_import_1615347506012,csv_import_1615347531585,csv_import_1615347567716,csv_import_1615347578724,csv_import_1615347591788,csv_import_1615347603145,csv_import_1615347621810,csv_import_1615347893358,csv_import_1615396541537,csv_import_1615396676407,csv_import_1615396823455,csv_import_1615396903474,csv_import_1615396997968,csv_import_1615397832923,csv_import_1615397931376,csv_import_1615397949971,csv_import_1615398652668,csv_import_1615399612258,csv_import_1615399647677,csv_import_1615399879690,csv_import_1615399911491,csv_import_1615399935813,csv_import_1615399980302,csv_import_1615400036474,csv_import_1615400050459,csv_import_1615400060500,csv_import_1615400146511,csv_import_1615400167168,csv_import_1615401111197,csv_import_1615401187126,csv_import_1615401287031,csv_import_1615401398387,csv_import_1615402399950,csv_import_1615402417574,csv_import_1615402433479,csv_import_1615402617463,csv_import_1615402804432,csv_import_1615403058704,csv_import_1615403151277,csv_import_1615403454887,csv_import_1615404105119,csv_import_1615404220428,csv_import_1615404334495,csv_import_1615404499568,csv_import_1615404887331,csv_import_1615405186641,csv_import_1615405649051,csv_import_1615406090612;


SELECT stusps, name, statefp, centroid_longitude, centroid_latitude
FROM cb_2018_us_state_20m states
ORDER by stusps;

drop table cb_2018_us_state_20m
create table cb_2018_us_state_20m as (
	with states as (
		select 
			stusps::varchar(2),
			name::varchar(100),
			statefp::varchar(2) as statefp,
			ST_X(ST_Centroid(shape))::numeric as centroid_longitude,
			ST_Y(ST_Centroid(shape))::numeric as centroid_latitude,
			shape as geom
		from cb_2018_us_state_20m_raw
		order by statefp::int4
	)
	select 
		(ROW_NUMBER () OVER ())::int4 as id,
		*
	from states
)
select * from cb_2018_us_state_20m

select * from cb_2018_us_state_20m

drop table cb_2018_us_cd116_20m
create table cb_2018_us_cd116_20m as (
	select 
		id,
		statefp::varchar(2) as statefp,
		geom
	from cb_2018_us_cd116_20m_raw
)

SELECT districts.*, states.stusps as state_abbrev, states.name as state_name
FROM cb_2018_us_state_20m states
JOIN cb_2018_us_cd116_20m districts on districts.statefp = states.statefp
WHERE stusps = 'CO'

SELECT 
  ST_Simplify(geom,.02) as geom,
  stusps, 
  name,
  statefp,
  centroid_longitude,
  centroid_latitude
FROM cb_2018_us_state_20m states
WHERE stusps = 'IN' 
ORDER by stusps

create table cb_2018_us_county_20m as (
	select
		id,
		name,
		statefp::varchar(2) as statefp,
		countyfp,
		countyns,
		affgeoid,
		geoid,
		lsad,
		aland,
		awater,
		shape as geom
	from cb_2018_us_county_20m_raw
)

SELECT 
	county.id,
	ST_MakePoint(ST_X(ST_CENTROID(county.geom)), ST_Y(ST_CENTROID(county.geom))) as geom,
	round(ST_X(ST_CENTROID(county.geom))::numeric, 3) as centroid_longitude,
	round(ST_Y(ST_CENTROID(county.geom))::numeric, 3) as centroid_latitude,
	county.name,
	county.statefp,
	county.countyfp,
	county.countyns,
	county.affgeoid,
	county.geoid,
	county.lsad,
	county.aland,
	county.awater,
	state.name as state_name,
	state.stusps as state_stusps
FROM cb_2018_us_county_20m county
JOIN cb_2018_us_state_20m state on state.statefp = county.statefp
WHERE state.stusps = 'IN';

select * from csv_import_1658885543213
